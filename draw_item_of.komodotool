{
  "keyboard_shortcut": "", 
  "name": "draw_item_of", 
  "value": [
    "################################################################################\n\nsub draw_item_of_[[%b]] {\n        \n\tmy $data = __d ($_[0]);\t\n\n\t$_REQUEST {__focused_input} = '_label';\n\n\tdraw_form ({\n\t\n\t\t\tright_buttons => [del ($data)],\n\t\t\t\n\t\t\tno_edit => $data -> {no_del},\n\t\t\t\n\t\t\tpath => [\n\t\t\t\t{type => '[[%b]]', name => action_type_label},\n\t\t\t\t{type => '[[%b]]', name => $data -> {label}, id => $data -> {id}},\n\t\t\t],\n\t\t\t\n\t\t},\n\t\t\n\t\t$data,\n\t\t\n\t\t[\n\t\t\t{\n\t\t\t\tname    => 'label',\n\t\t\t\tlabel   => '\u041d\u0430\u0438\u043c\u0435\u043d\u043e\u0432\u0430\u043d\u0438\u0435',\n\t\t\t\tsize    => 40,\n\t\t\t\tmax_len => 255,\n\t\t\t},\n\n#\t\t\t{\n#\t\t\t\tname   => 'id_user',\n#\t\t\t\tlabel  => '\u041f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044c',\n#\t\t\t\ttype   => 'select',\n#\t\t\t\tvalues => $data -> {users},\n#\t\t\t\tempty  => '[\u0412\u044b\u0431\u0435\u0440\u0438\u0442\u0435 \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044f]',\n#\t\t\t\tother  => '/?type=users',\n#\t\t\t},\n\n#\t\t\t{\n#\t\t\t\tname   => 'id_org',\n#\t\t\t\tlabel  => '\u041e\u0440\u0433\u0430\u043d\u0438\u0437\u0430\u0446\u0438\u044f',\n#\t\t\t\ttype   => 'suggest',\n#\t\t\t\tsize    => 40,\n#\t\t\t\tvalues => sub {sql (orgs => ['id',\n#\t\t\t\t\t['label LIKE ?%%' => $_REQUEST {_id_org}],\n#\t\t\t\t])},\n#\t\t\t},\n\n\t\t],\n\n\t)\n\n\t.\n\n\tdraw_table (\n\n\t\tsub {\n\t\t\n\t\t\t__d ($i);\n\t\t\n\t\t\tdraw_cells ({\n\t\t\t\tbgcolor => $i -> {id} == $data -> {id} ? '#ffffd0' : undef,\n\t\t\t},[\n\t\t\t\t{\n\t\t\t\t\ttype => 'checkbox',\n\t\t\t\t\tname => \"_clone_$$i{id}\",\n\t\t\t\t\toff  => $i -> {id} == $data -> {id},\n\t\t\t\t},\n\t\t\t\t\n\t\t\t\t$i -> {label},\n\t\t\t\t\n\t\t\t]),\n\t\t\n\t\t},\n\t\t\n\t\t$data -> {clones},\n\t\t\n\t\t{\n\t\t\t\n\t\t\ttitle => {label => '\u041f\u043e\u0445\u043e\u0436\u0438\u0435 \u043d\u0430\u0437\u0432\u0430\u043d\u0438\u044f'},\n\t\t\t\n\t\t\toff   => !$_REQUEST{__read_only} || @{$data -> {clones}} < 2,\n\t\t\t\n\t\t\tname  => 't1',\n\t\t\t\t\t\t\n\t\t\ttop_toolbar => [{\n\t\t\t\tkeep_params => ['type', 'id'],\n\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tname  => 'first',\n\t\t\t\t\ttype  => 'input_text',\n\t\t\t\t\tlabel => '\u041f\u043e \u0441\u043a\u043e\u043b\u044c\u043a\u0438\u043c \u0431\u0443\u043a\u0432\u0430\u043c',\n\t\t\t\t\tsize  => 2,\n\t\t\t\t\tkeep_params => [],\n\t\t\t\t},\n\t\t\t],\n\t\t\t\n\t\t\ttoolbar => draw_centered_toolbar ({},\n\t\t\t\t\n\t\t\t\t[\n\t\t\t\t\t{\n\t\t\t\t\t\ticon  => 'delete',\n\t\t\t\t\t\tlabel => '\u0441\u043b\u0438\u0442\u044c \u0432\u044b\u0434\u0435\u043b\u0435\u043d\u043d\u044b\u0435 \u0437\u0430\u043f\u0438\u0441\u0438 \u0441 \u0442\u0435\u043a\u0443\u0449\u0435\u0439',\n\t\t\t\t\t\thref  => \"javaScript:if(confirm('\u0412\u044b \u0443\u0432\u0435\u0440\u0435\u043d\u044b, \u0447\u0442\u043e \u0432\u0441\u0435 \u0432\u044b\u0434\u0435\u043b\u0435\u043d\u043d\u044b\u0435 \u0437\u0430\u043f\u0438\u0441\u0438 \u0441\u043e\u0432\u043f\u0430\u0434\u0430\u044e\u0442 \u043f\u043e \u0441\u043c\u044b\u0441\u043b\u0443 \u0441 \u0442\u0435\u043a\u0443\u0449\u0435\u0439?')) document.forms ['t1'].submit()\",\n\t\t\t\t\t}\n\t\t\t\t]\n\n\t\t\t),\n\n\t\t}\n\n\t);\n}\n\n!@#_currentPos!@#_anchor"
  ], 
  "set_selection": "true", 
  "type": "snippet", 
  "indent_relative": "false"
}